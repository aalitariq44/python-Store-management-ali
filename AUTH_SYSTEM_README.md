# نظام إدارة المتجر مع نظام تسجيل الدخول

## المميزات الجديدة

### نظام تسجيل الدخول
- **الإعداد الأولي**: عند تشغيل التطبيق لأول مرة، سيطلب منك إدخال كلمة مرور مرتين
- **تسجيل الدخول**: عند كل تشغيل للتطبيق، ستحتاج لإدخال كلمة المرور
- **تغيير كلمة المرور**: يمكن تغيير كلمة المرور من قائمة الإعدادات

## هيكل نظام التسجيل

```
auth/
├── __init__.py
├── controllers/
│   ├── __init__.py
│   └── auth_controller.py          # كنترولر إدارة التسجيل
└── views/
    ├── __init__.py
    ├── login_dialog.py             # شاشة تسجيل الدخول
    ├── first_time_setup_dialog.py  # شاشة الإعداد الأولي
    └── password_settings_dialog.py # شاشة إعدادات كلمة المرور
```

## الملفات المعدلة

### database/models.py
- إضافة نموذج `AuthSettings` لحفظ إعدادات التسجيل

### database/database_connection.py
- إضافة جدول `auth_settings` لحفظ كلمات المرور

### main.py
- دمج نظام التسجيل في التطبيق الرئيسي
- التحقق من الإعداد الأولي
- عرض شاشة تسجيل الدخول

### views/main_window.py
- إضافة قائمة "إعدادات" مع خيار "إعدادات كلمة المرور"
- إضافة دالة `open_password_settings()`

## تسلسل التشغيل

1. **التشغيل الأول**:
   - عرض شاشة "إعداد كلمة المرور"
   - طلب إدخال كلمة المرور مرتين
   - حفظ كلمة المرور في قاعدة البيانات

2. **التشغيل العادي**:
   - عرض شاشة "تسجيل الدخول"
   - طلب إدخال كلمة المرور
   - التحقق من صحة كلمة المرور
   - فتح النافذة الرئيسية عند النجاح

3. **تغيير كلمة المرور**:
   - من القائمة الرئيسية: إعدادات ← إعدادات كلمة المرور
   - إدخال كلمة المرور الحالية
   - إدخال كلمة المرور الجديدة مرتين
   - حفظ التغييرات

## الأمان

- كلمات المرور محفوظة في قاعدة البيانات **بدون تشفير** كما طُلب
- النظام يتحقق من صحة كلمة المرور عند كل تشغيل
- لا يمكن الوصول للتطبيق بدون كلمة المرور الصحيحة

## كيفية الاستخدام

### تشغيل التطبيق لأول مرة
```bash
python main.py
```
ستظهر شاشة إعداد كلمة المرور:
1. أدخل كلمة المرور المرغوبة
2. أعد إدخالها للتأكيد
3. اضغط "إعداد كلمة المرور"

### تشغيل التطبيق العادي
```bash
python main.py
```
ستظهر شاشة تسجيل الدخول:
1. أدخل كلمة المرور
2. اضغط "تسجيل الدخول" أو Enter

### تغيير كلمة المرور
من داخل التطبيق:
1. اذهب إلى قائمة "إعدادات"
2. اختر "إعدادات كلمة المرور"
3. أدخل كلمة المرور الحالية
4. أدخل كلمة المرور الجديدة مرتين
5. اضغط "حفظ التغييرات"

## قاعدة البيانات

تمت إضافة جدول جديد:

```sql
CREATE TABLE auth_settings (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    password TEXT NOT NULL,
    is_first_time BOOLEAN DEFAULT TRUE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

## رسائل الخطأ المحتملة

- **"كلمتا المرور غير متطابقتان"**: تأكد من إدخال نفس كلمة المرور في الحقلين
- **"كلمة المرور لا يمكن أن تكون فارغة"**: أدخل كلمة مرور صالحة
- **"كلمة المرور غير صحيحة"**: تأكد من إدخال كلمة المرور الصحيحة
- **"كلمة المرور القديمة غير صحيحة"**: عند تغيير كلمة المرور، تأكد من إدخال كلمة المرور الحالية بشكل صحيح

## الإضافات المستقبلية (اختيارية)

يمكن تطوير النظام لاحقاً بإضافة:
- تشفير كلمات المرور
- عدد محاولات تسجيل دخول محدود
- انتهاء صلاحية كلمة المرور
- سجل أنشطة تسجيل الدخول
